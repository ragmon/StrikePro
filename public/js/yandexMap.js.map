{"version":3,"names":[],"mappings":"","sources":["yandexMap.js"],"sourcesContent":["\n//var Location;\n// карта\nvar map;\n// массив с координатами и id маркеров\nvar points = [];\n// коллекция с маркерами карты\nvar ObjectsPoints = [];\nvar markersCollection;\n// стили для маркеров карты\nvar markerStyle = {\n    iconLayout: 'default#imageWithContent',\n    iconImageHref: yandexMap_config.iconImageHref,\n    iconImageSize: yandexMap_config.iconImageSize,\n    iconImageOffset: yandexMap_config.iconImageOffset\n};\n\n// инициализация карты\nfunction init() {\n    map = new ymaps.Map(\"GMap\", {\n        center: [55.76, 37.64],\n        zoom: 10\n    }, {\n        searchControlProvider: 'yandex#search'\n    });\n    // создание маркеров, на входи принимает ссылку на обект\n    markerInit(Location[Object.keys(Location)[0]]);\n}\n// конструктор обекта с координатами и id маркеров\nvar pointsConstruct = function (lat, lng, id) {\n    this.coords = [lat, lng];\n    this.id = id;\n};\n// создание маркеров\nfunction markerInit(locationOBJ) {\n    clearMarkers(); // метод очистки коллекции маркеров\n\n    city = locationOBJ, // переданный в функцию обект\n        store = city.stores, // список городов\n        markersCollection = new ymaps.ObjectManager({\n            clusterize: false\n        }); // создаем экземпляр гео коллекции, в ней будут хранится маркеры\n    // метод выставляет центр карты и делает зум\n    map.setCenter([city.center.lat, city.center.lng], 10, {\n        checkZoomRange: true\n    });\n\n    // заполняем массив с информацией о координатах и id маркеров\n    for (var i = 0; i < store.length; i++) {\n        points.push(new pointsConstruct(store[i].lat, store[i].lng, store[i].id));\n    }\n\n    // добавляем маркеры в гео коллекцию\n    for (var i = 0, l = points.length; i < l; i++) {\n        ObjectsPoints.push({\n            type: 'Feature',\n            id: points[i].id,\n            geometry: {\n                type: 'Point',\n                coordinates: points[i].coords\n            },\n            options: {\n                iconLayout: 'default#imageWithContent',\n                iconImageHref: yandexMap_config.iconImageHref,\n                iconImageSize: [36, 43],\n                iconImageOffset: [-20, -20]\n            },\n            properties: {\n                // Контент метки.\n                iconContent: \"<span class='yamap_point'>\" + points[i].id + \"</span\"\n            }\n        });\n    }\n\n    markersCollection.add(ObjectsPoints);\n    map.geoObjects.add(markersCollection);\n\n    // Функция вызываемая при наведении на маркер\n    function onObjectEvent(e) {\n        var objectId = e.get('objectId');\n        if (e.get('type') == 'mouseenter') {\n            changeMarker(objectId, \"hover\")\n            LocationItemHover(objectId);\n\n        } else {\n            changeMarker(objectId)\n            LocationItemOnHover(objectId);\n        }\n    }\n    // Обработчик события наведения на маркер\n    markersCollection.objects.events.add(['mouseenter', 'mouseleave'], onObjectEvent);\n\n\n}\n\n\nymaps.ready(init);\n\n\n\nfunction clearMarkers() {\n    if (markersCollection) {\n        markersCollection.remove(ObjectsPoints);\n        ObjectsPoints.splice(0, ObjectsPoints.length);\n        points.splice(0, points.length);\n    }\n}\n\nfunction changeMarker(objectId, status) {\n    clearMarker();\n    if (status == \"hover\") {\n        markersCollection.objects.setObjectOptions(objectId, {\n            iconImageHref: yandexMap_config.iconImageHoverHref\n        });\n    } else {\n        markersCollection.objects.setObjectOptions(objectId, {\n            iconImageHref: yandexMap_config.iconImageHref\n        });\n    }\n}\n\nfunction clearMarker() {\n    for (var i = 0; i < ObjectsPoints.length; i++)\n        markersCollection.objects.setObjectOptions(i + 1, {\n            iconImageHref: yandexMap_config.iconImageHref\n        });\n\n}\n$(\".location__tabs li a\").on(\"click\", function (event) {\n    event.preventDefault();\n    $(\".location__item\").removeClass(\"active\");\n    var $this = $($(this));\n    var link = $this.attr(\"href\");\n    if ($this.closest(\"li\").hasClass(\"active\")) {\n        return\n    }\n    $(\".location__tabs li\").removeClass(\"active\");\n    $this.closest(\"li\").addClass(\"active\");\n    $(\".location__list\").removeClass(\"active\");\n    $(link).addClass(\"active\");\n\n    link = link.substring(1);\n    markerInit(Location[link]);\n})\n\n\n\n\nvar hoverColor = \"#eaeaea\";\n\n\n$(\".location__item\").on(\"click\", function (event) {\n    var itemList = $(\".location__item\");\n\n    for (var i = 0; i < itemList.length; i++) {\n        $(itemList[i]).removeClass(\"active\");\n    }\n    if ($(this).hasClass(\"active\")) {\n        return\n    }\n    $(this).addClass(\"active\");\n\n    var objectId = parseInt($(this).find(\".location__title-num\").text(), 10);\n    clearMarker();\n    changeMarker(objectId, \"hover\");\n\n})\n\n$(\".location__item\").hover(LocationItemHover, LocationItemOnHover);\n\nfunction LocationItemHover(id) {\n\n    if ($(this).hasClass(\"active\")) {\n        return\n    }\n    $(\".location__item.active\").css({\n        \"background-color\": \"transparent\"\n    })\n    if ($(this).hasClass(\"location__item\")) {\n        $(this).css({\n            \"background-color\": hoverColor\n        })\n        var objectId = parseInt($(this).find(\".location__title-num\").text(), 10);\n        clearMarker();\n        changeMarker(objectId, \"hover\");\n    }\n    if (id) {\n        var arrayIdLocationItem = [];\n        var num = $(\".location__list.active\").find(\".location__item\");\n        for (var i = 0; i < num.length; i++) {\n            if (id == i + 1) {\n                $(num[i]).css({\n                    \"background-color\": hoverColor\n                })\n            }\n        }\n        return\n    }\n}\n\nfunction LocationItemOnHover(id) {\n    if ($(this).hasClass(\"active\")) {\n        return\n    }\n    $(\".location__item.active\").css({\n        \"background-color\": hoverColor\n    })\n    if ($(this).hasClass(\"location__item\")) {\n        $(this).css({\n            \"background-color\": \"transparent\"\n        })\n        clearMarker();\n        var objectId = parseInt($(\".location__item.active\").find(\".location__title-num\").text(), 10);\n        clearMarker();\n        changeMarker(objectId, \"hover\");\n    }\n    if (id) {\n        var num = $(\".location__list.active\").find(\".location__item\");\n        for (var i = 0; i < num.length; i++) {\n            if ($(num[i]).hasClass(\"active\")) {\n                clearMarker();\n                changeMarker(i + 1, \"hover\");\n            } else if (id == i + 1) {\n                $(num[i]).css({\n                    \"background-color\": \"transparent\"\n                })\n            }\n        }\n        return\n    }\n\n\n}\n"],"file":"yandexMap.js"}